<% provide(:title, 'Auditor: All Action Plans') %>
<h1>Auditor: All Action Plans</h1>

<table class="table table-striped table-bordered">
    <tr>
      <th>Belongs to Issue</th>
      <th>Description</th>
      <th>Submitted by</th>
      <th>Status</th>
      <th>Final Review Date</th>
      <th>Final Implementation Date</th>
      <th>Marked as Implemented?</th>
      <th></th>

    </tr>

    <% @action_plans.each do |ap| %>
    	<tr>
	    	<td><% if ap.issue_id == nil %>
            Issue Title
          <% else %>
            <%= Issue.find(ap.issue_id).title %>
          <% end %>
        </td>
	    	<td><%= ap.description %></td>
	    	<td><% if ap.responsible_officer_id == nil %>
            User name
          <% else %>
            <%= User.find(ap.responsible_officer_id).name %>
          <% end %>
        </td>
        <td><%= ActionPlanStatus.find(ap.ap_status_id).name %></td>
	    	<td><%= ap.final_review_date %></td>
	    	<td><%= ap.final_implementation_review_date %></td>
        <td><%= ap.implemented==true ? 'Yes' : 'No' %></td>
	    	<td> 
	    		<%= link_to "View", [:auditor, ap], class: "btn btn-link" %>
	    	</td>
	    </tr>
    <% end %>
</table>
<%= will_paginate @action_plans %>

<h2>Action Plans for marking as Implemented</h2>
<table class="table table-striped table-bordered">
    <tr>
      <th>Belongs to Issue</th>
      <th>Description</th>
      <th>Submitted by</th>
      <th>Status</th>
      <th></th>
    </tr>

    <% @action_plans_markasimplement.each do |ap| %>
      <tr>
        <td><% if ap.issue_id == nil %>
            Issue Title
          <% else %>
            <%= Issue.find(ap.issue_id).title %>
          <% end %>
        </td>
        <td><%= ap.description %></td>
        <td><% if ap.responsible_officer_id == nil %>
            User name
          <% else %>
            <%= User.find(ap.responsible_officer_id).name %>
          <% end %>
        </td>
        <td><%= ActionPlanStatus.find(ap.ap_status_id).name %></td>
        <td> 
          <%= link_to "View", [:auditor, ap], class: "btn btn-link" %>
        </td>
      </tr>
    <% end %>
  </table>
<%= will_paginate @action_plans_markasimplement %>