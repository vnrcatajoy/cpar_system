<% provide(:title, 'Officer: Issues Index') %>
<h1><%= "Issues assigned to #{current_user.name}" %></h1>
<h2><%= "Department: #{Department.where(id: current_user.department_id).first.name}" %></h2>
<table class="table table-striped table-bordered">
    <tr>
      <th>Title</th>
      <th>Originator</th>
      <th>Impact</th>
      <th>Status</th> <!--replaced Department in favor of Status-->
      <th>Type</th>
      <th>ISO Id</th>
      <th>Assigned To</th>

    </tr>

    <% @issues.each do |issue| %>
      <tr>
        <td> <%= link_to issue.title, officer_issue_path(issue) %> </td>
        <td> <%= issue.user.name %> </td>
        <td> <% if issue.impact_id == 1 %>
              <span class="label label-important"><%= issue.issue_impact.name %></spn>
              <% elsif issue.impact_id == 2 %>
                <span class="label label-warning"><%= issue.issue_impact.name %></spn>
              <% else %>
                <span class="label label-info"><%= issue.issue_impact.name %></spn>
            <% end %>
        </td>
        <td> <%= issue.issue_status.name %> </td>
        <td> <%= issue.issue_type.name %></td>
        <td> <%= issue.iso_nc.title %></td>
        <td><% if issue.responsible_officer_id == nil %>
                None
             <% else %>
                <%= User.find(issue.responsible_officer_id).name %>
             <% end %>
        </td>
      </tr>
    <% end %>

  </table>
  <%= will_paginate @issues %>

<h2>All Issues Assigned to You</h2>
<table class="table table-striped table-bordered">
    <tr>
      <th>Title</th>
      <th>Originator</th>
      <th>Impact</th>
      <th>Status</th>
      <th>Type</th>
      <th>ISO Id</th>

    </tr>

    <% @issues_yours.each do |issue| %>
      <tr>
        <td> <%= link_to issue.title, officer_issue_path(issue) %> </td>
        <td> <%= issue.user.name %> </td>
        <td> <% if issue.impact_id == 1 %>
              <span class="label label-important"><%= issue.issue_impact.name %></spn>
              <% elsif issue.impact_id == 2 %>
                <span class="label label-warning"><%= issue.issue_impact.name %></spn>
              <% else %>
                <span class="label label-info"><%= issue.issue_impact.name %></spn>
            <% end %>
        </td>
        <td> <%= issue.issue_status.name %> </td>
        <td> <%= issue.issue_type.name %></td>
        <td> <%= issue.iso_nc.title %></td>
      </tr>
    <% end %>

  </table>
  <%= will_paginate @issues_yours %>

  <h2>All Issues Secondarily Assigned to You</h2>
<table class="table table-striped table-bordered">
    <tr>
      <th>Title</th>
      <th>Originator</th>
      <th>Impact</th>
      <th>Main Department</th>
      <th>Status</th>

    </tr>

    <% @issues_secondary.each do |issue| %>
      <tr>
        <td> <%= link_to issue.title, officer_issue_path(issue) %> </td>
        <td> <%= issue.user.name %> </td>
        <td> <% if issue.impact_id == 1 %>
              <span class="label label-important"><%= issue.issue_impact.name %></spn>
              <% elsif issue.impact_id == 2 %>
                <span class="label label-warning"><%= issue.issue_impact.name %></spn>
              <% else %>
                <span class="label label-info"><%= issue.issue_impact.name %></spn>
            <% end %>
        </td>
        <td> <%= issue.department.name %> </td>
        <td> <%= issue.issue_status.name %> </td>
      </tr>
    <% end %>

  </table>
  <!-- no paginate for array will_paginate @issues_secondary -->

  <h2>Issues with Ongoing Closeout Forms</h2>
  <table class="table table-striped table-bordered">
    <tr>
      <th>Title</th>
      <th>Originator</th>
      <th>Impact</th>
      <th>Main Department</th>

    </tr>

    <% @issues_closeout.each do |issue| %>
      <tr>
        <td> <%= link_to issue.title, details_officer_issue_path(issue) %> </td>
        <td> <%= issue.user.name %> </td>
        <td> <% if issue.impact_id == 1 %>
              <span class="label label-important"><%= issue.issue_impact.name %></spn>
              <% elsif issue.impact_id == 2 %>
                <span class="label label-warning"><%= issue.issue_impact.name %></spn>
              <% else %>
                <span class="label label-info"><%= issue.issue_impact.name %></spn>
            <% end %>
        </td>
        <td> <%= issue.department.name %> </td>
      </tr>
    <% end %>

  </table>
  <%= will_paginate @issues_closeout %>